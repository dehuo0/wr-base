diff --git a/file.c b/file.c
--- a/file.c	2013-01-06 15:51:17.000000000 +0800
+++ b/file.c	2013-01-06 15:59:14.000000000 +0800
@@ -174,6 +174,9 @@ rb_get_path_check(VALUE obj, int level)
 	rb_raise(rb_eEncCompatError, "path name must be ASCII-compatible (%s): %s",
 		 rb_enc_name(enc), RSTRING_PTR(tmp));
     }
+
+    StringValueCStr(tmp);
+
     return rb_str_new4(tmp);
 }
 
diff --git a/test/ruby/test_file.rb b/test/ruby/test_file.rb
--- a/test/ruby/test_file.rb	2013-01-06 15:56:34.000000000 +0800
+++ b/test/ruby/test_file.rb	2013-01-06 15:58:11.000000000 +0800
@@ -189,4 +189,15 @@ class TestFile < Test::Unit::TestCase
       assert_equal(File.chmod(0666, file), 1, bug5671)
     end
   end
+
+  def test_open_nul
+    Dir.mktmpdir(__method__.to_s) do |tmpdir|
+      path = File.join(tmpdir, "foo")
+      assert_raise(ArgumentError) do
+        open(path + "\0bar", "w") {}
+      end
+      refute File.exist?(path)
+    end
+  end
+  
 end
